modifier: PMario
created: 201108311212
modified: 201108311213
tags: systemConfig

//{{{
CodeMirror.defineMode("python",function(a){function c(a){return new RegExp("^(("+a.join(")|(")+"))\\b")}function s(a,c){if(a.sol()){var k=c.scopes[0].offset;if(a.eatSpace()){var l=a.indentation();return l>k?r="indent":l<k&&(r="dedent"),null}k>0&&v(a,c)}if(a.eatSpace())return null;var m=a.peek();if(m==="#")return a.skipToEnd(),"comment";if(a.match(/^[0-9\.]/,!1)){var n=!1;a.match(/^\d*\.\d+(e[\+\-]?\d+)?/i)&&(n=!0),a.match(/^\d+\.\d*/)&&(n=!0),a.match(/^\.\d+/)&&(n=!0);if(n)return a.eat(/J/i),"number";var s=!1;a.match(/^0x[0-9a-f]+/i)&&(s=!0),a.match(/^0b[01]+/i)&&(s=!0),a.match(/^0o[0-7]+/i)&&(s=!0),a.match(/^[1-9]\d*(e[\+\-]?\d+)?/)&&(a.eat(/J/i),s=!0),a.match(/^0(?![\dx])/i)&&(s=!0);if(s)return a.eat(/L/i),"number"}return a.match(o)?(c.tokenize=t(a.current()),c.tokenize(a,c)):a.match(h)||a.match(g)?null:a.match(f)||a.match(d)||a.match(j)?"operator":a.match(e)?null:a.match(q)?"builtin":a.match(p)?"keyword":a.match(i)?"variable":(a.next(),b)}function t(c){while("rub".indexOf(c[0].toLowerCase())>=0)c=c.substr(1);var d=new RegExp(c),e=c.length==1,f="string";return function g(c,g){while(!c.eol()){c.eatWhile(/[^'"\\]/);if(c.eat("\\")){c.next();if(e&&c.eol())return f}else{if(c.match(d))return g.tokenize=s,f;c.eat(/['"]/)}}if(e){if(a.mode.singleLineStringErrors)return b;g.tokenize=s}return f}}function u(b,c,d){d=d||"py";var e=0;if(d==="py"){for(var f=0;f<c.scopes.length;++f)if(c.scopes[f].type==="py"){e=c.scopes[f].offset+a.indentUnit;break}}else e=b.column()+b.current().length;c.scopes.unshift({offset:e,type:d})}function v(a,b){if(b.scopes.length==1)return;if(b.scopes[0].type==="py"){var c=a.indentation(),d=-1;for(var e=0;e<b.scopes.length;++e)if(c===b.scopes[e].offset){d=e;break}if(d===-1)return!0;while(b.scopes[0].offset!==c)b.scopes.shift();return!1}return b.scopes.shift(),!1}function w(a,c){r=null;var d=c.tokenize(a,c),e=a.current();if(e===".")return d=c.tokenize(a,c),e=a.current(),d==="variable"?"variable":b;if(e==="@")return d=c.tokenize(a,c),e=a.current(),d==="variable"||e==="@staticmethod"||e==="@classmethod"?"meta":b;if(e==="pass"||e==="return")c.dedent+=1;(e===":"&&!c.lambda&&c.scopes[0].type=="py"||r==="indent")&&u(a,c);var f="[({".indexOf(e);return f!==-1&&u(a,c,"])}".slice(f,f+1)),r==="dedent"&&v(a,c)?b:(f="])}".indexOf(e),f!==-1&&v(a,c)?b:(c.dedent>0&&a.eol()&&c.scopes[0].type=="py"&&(c.scopes.length>1&&c.scopes.shift(),c.dedent-=1),d))}var b="error",d=new RegExp("^[\\+\\-\\*/%&|\\^~<>!]"),e=new RegExp("^[\\(\\)\\[\\]\\{\\}@,:`=;\\.]"),f=new RegExp("^((==)|(!=)|(<=)|(>=)|(<>)|(<<)|(>>)|(//)|(\\*\\*))"),g=new RegExp("^((\\+=)|(\\-=)|(\\*=)|(%=)|(/=)|(&=)|(\\|=)|(\\^=))"),h=new RegExp("^((//=)|(>>=)|(<<=)|(\\*\\*=))"),i=new RegExp("^[_A-Za-z][_A-Za-z0-9]*"),j=c(["and","or","not","is","in"]),k=["as","assert","break","class","continue","def","del","elif","else","except","finally","for","from","global","if","import","lambda","pass","raise","return","try","while","with","yield"],l=["bool","classmethod","complex","dict","enumerate","float","frozenset","int","list","object","property","reversed","set","slice","staticmethod","str","super","tuple","type"],m={types:["basestring","buffer","file","long","unicode","xrange"],keywords:["exec","print"]},n={types:["bytearray","bytes","filter","map","memoryview","open","range","zip"],keywords:["nonlocal"]};if(!a.mode.version||parseInt(a.mode.version,10)!==3){k=k.concat(m.keywords),l=l.concat(m.types);var o=new RegExp("^(([rub]|(ur)|(br))?('{3}|\"{3}|['\"]))","i")}else{k=k.concat(n.keywords),l=l.concat(n.types);var o=new RegExp("^(([rb]|(br))?('{3}|\"{3}|['\"]))","i")}var p=c(k),q=c(l),r=null,x={startState:function(a){return{tokenize:s,scopes:[{offset:a||0,type:"py"}],lastToken:null,lambda:!1,dedent:0}},token:function(a,b){var c=w(a,b);return b.lastToken={style:c,content:a.current()},a.eol()&&a.lambda&&(b.lambda=!1),c},indent:function(a,b){return a.tokenize!=s?0:a.scopes[0].offset}};return x}),CodeMirror.defineMIME("text/x-python","python")
//}}}
